<script setup lang="ts">
import WorksList from './components/WorksList'
import type { DataListItem } from './components/WorksList'
import PublishWorksBtn from './components/PublishWorksBtn'

function handleSearch(searchValue) {
  console.log('ğŸš€ ~ handleSearch ~ searchValue:', searchValue)
}

const worksTabList = [
  { title: 'æœ€å¤šä½œå“', key: '1' },
  { title: 'æœ€çƒ­ä½œå“', key: '2' },
  { title: 'æµè§ˆæœ€å¤š', key: '3' },
]
const worksActiveTab = ref('1')

function handleTabChange() {
  studentClassActiveTab.value = worksActiveTab.value
}

const studentClassList = [
  { title: 'ä¸€å¹´çº§ï¼ˆ1ï¼‰ç­', key: '1' },
  { title: 'ä¸€å¹´çº§ï¼ˆ2ï¼‰ç­', key: '2' },
  { title: 'ä¸€å¹´çº§ï¼ˆ3ï¼‰ç­', key: '3' },
  { title: 'ä¸€å¹´çº§ï¼ˆ4ï¼‰ç­', key: '4' },
  { title: 'ä¸€å¹´çº§ï¼ˆ5ï¼‰ç­', key: '5' },
  { title: 'ä¸€å¹´çº§ï¼ˆ6ï¼‰ç­', key: '6' },
]
const studentClassActiveTab = ref('1')

const worksListData = reactive<DataListItem[]>(
  [
    {
      id: '1',
      name: 'æ±¤æ€ä½³',
      title: 'ä½œå“åç§°',
      worksData: ['1', '2', '3', '4'],
      className: 'ä¸€å¹´çº§ï¼ˆ1ï¼‰ç­',
      date: '10æœˆ27æ—¥',
      rank: 1,
      isVote: true,
      voteNum: 9,
      isLike: true,
      likeNum: 999,
      likeText: 'æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ä½³,æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ä½³',
      voteText: 'æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ä½³,æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ä½³',
    },
    {
      id: '2',
      name: 'å¼ äº‘æ—',
      title: 'æ´»åŠ¨ä½œå“',
      worksData: ['1'],
      className: 'ä¸€å¹´çº§ï¼ˆ1ï¼‰ç­',
      date: '10æœˆ27æ—¥',
      rank: 2,
      isVote: false,
      voteNum: 9,
      isLike: true,
      likeNum: 999,
      likeText: 'æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ä½³,æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ä½³',
      voteText: 'æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ä½³,æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ä½³',
    },
    {
      id: '3',
      name: 'å°šè¾¾é›…',
      title: 'äº”å¹´çº§(ä¸Šå†Œ):åœ°éœ‡ä¸­çš„çˆ¶ä¸å­',
      worksData: ['1'],
      className: 'ä¸€å¹´çº§ï¼ˆ1ï¼‰ç­',
      date: '10æœˆ27æ—¥',
      rank: 3,
      isVote: true,
      voteNum: 9,
      isLike: false,
      likeNum: 999,
      likeText: 'æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ä½³,æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ä½³',
      voteText: 'æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ä½³,æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ä½³',
    },
    {
      id: '4',
      name: 'æˆ‘çš„åå­—è¶…é•¿å•Šå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ',
      title: 'äº”å¹´çº§(ä¸Šå†Œ):åœ°éœ‡ä¸­çš„çˆ¶ä¸å­',
      worksData: ['1'],
      className: 'ä¸€å¹´çº§ï¼ˆ1ï¼‰ç­',
      date: '10æœˆ27æ—¥',
      rank: 3,
      voteNum: 9,
      isVote: false,
      isLike: false,
      likeNum: 999,
      likeText: 'æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ä½³,æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ä½³',
      voteText: 'æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ä½³,æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ã€æ±¤æ€ä½³ä½³',
    },
  ],
)
function handleLike(itemData, index) {
  worksListData[index].isLike = !worksListData[index].isLike
  console.log('ğŸš€ ~ handleLike ~ handleLike:', itemData)
}
function handleVote(itemData, index) {
  worksListData[index].isVote = !worksListData[index].isVote
  console.log('ğŸš€ ~ handleVote ~ handleVote:', itemData)
}
const actions = [
  { name: 'åˆ é™¤ä½œå“' },
  { name: 'ä¸¾æŠ¥ä½œå“' },
]
const show = ref(false)
function onSelect(item) {
  // é»˜è®¤æƒ…å†µä¸‹ç‚¹å‡»é€‰é¡¹æ—¶ä¸ä¼šè‡ªåŠ¨æ”¶èµ·
  // å¯ä»¥é€šè¿‡ close-on-click-action å±æ€§å¼€å¯è‡ªåŠ¨æ”¶èµ·
  show.value = false
  showToast(item.name)
}
function handleChange(itemData, index) {
  console.log('ğŸš€ ~ handleChange ~ handleChange:', itemData, index)
  show.value = true
}
</script>

<template>
  <div class="works-page" pb-460>
    <HeaderSearch placeholder="æœç´¢æ´»åŠ¨åç§°" @search="handleSearch" />
    <Tab v-model="worksActiveTab" :tab-list="worksTabList" :swipeable="false" @change="handleTabChange">
      <VanTabs v-model:active="studentClassActiveTab" :swipeable="true" :animated="true" class="student-class-tabs" type="card">
        <VanTab v-for="item in studentClassList" :key="item.key" :title="item.title">
          <WorksList :data-list="worksListData" :like="handleLike" :vote="handleVote" @change="handleChange" />
        </VanTab>
      </VanTabs>
    </Tab>
    <PublishWorksBtn />
    <VanActionSheet v-model:show="show" :actions="actions" cancel-text="å–æ¶ˆ" @select="onSelect" />
  </div>
</template>

<style scoped lang="less">
.works-page {
  :deep(.student-class-tabs) {
    background-color: #fff;
    .van-tabs__wrap {
      height: 104px;
    }
    .van-tabs__nav--card {
      height: 100%;
      border: none;
      padding-top: 24px;
      padding-bottom: 24px;
    }
    .van-tab {
      font-size: 24px;
      border: none;
      width: auto;
      flex: none;
      flex-shrink: 0;
      background-color: #f0f2f5;
      border-radius: 8px;
      color: #272e3b;
      padding: 8px 14px;
      margin-left: 24px;
      &:nth-child(1) {
        margin-left: 0;
      }
      &.van-tab--active {
        background: #2c68ff;
        color: #fff;
        font-weight: normal;
      }
    }
  }
}
</style>
